View(response)
url = "https://environment.data.gov.uk/"
response <- GET(url, path = "ecology/api/v1/sites", query = "skip=0&take=5&mode=minimal&distance_km=5", add_headers(Accept = "application/json"))
jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
response <- GET(url, path = "ecology/api/v1/sites", query = "skip=0&take=5&mode=minimal&distance_km=5")
jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
data <- jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
data
library(tidyverse)
map(data, data.frame)
data2 <- map(data, data.frame)
response <- GET(url, path = "ecology/api/v1/sites", query = "lat=51.44553&long=-2.54344&distance=5")
data <- jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
map(data, data.frame)
map(data, data.frame) %>% bind_rows()
site = 10060
url = "http://environment.data.gov.uk/"
path = "ecology/site/bio/"
response <- GET(url, path = path,
query = site)
jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
data1 <- jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
data1 <- map(data, data.frame) %>% bind_rows()
url = "http://environment.data.gov.uk/"
path = "ecology/site/bio/"
response <- GET(url, path = path,
query = site)
data1 <- jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
data1 <- map(data, data.frame) %>% bind_rows()
site = 10060
url = "http://environment.data.gov.uk/"
path = "ecology/site/bio/"
response <- GET(url, path = path,
query = site)
data1 <- jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
data1 <- map(data, data.frame) %>% bind_rows()
url = "http://environment.data.gov.uk/"
path = "ecology/site/bio/"
response <- GET(url, path = path,
query = site)
site = 10060
url = "http://environment.data.gov.uk/"
path = "ecology/site/bio/"
response <- GET(url, path = path,
query = site)
site = "http://environment.data.gov.uk/ecology/site/bio/10036"
paste0("ecology/site/bio/", site)
url = "http://environment.data.gov.uk/"
path = paste0("ecology/sites/", site)
paste0("ecology/sites/", site)
site = "http://environment.data.gov.uk/ecology/site/bio/10036"
url = "http://environment.data.gov.uk/"
paste0("ecology/sites/", site)
site
paste0("ecology/sites/", site)
path = paste0("ecology/sites/", site)
response <- GET(url, path = path,
query = site)
data1 <- jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
response
url
path
site = "10036"
url = "http://environment.data.gov.uk/"
path = paste0("ecology/sites/http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F10036", site)
path
path = paste0("ecology/sites/http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F", site)
path
response <- GET(url, path = path,
query = site)
jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
path
path = paste0("sites/http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F", site)
response <- GET(url, path = path,
query = site)
jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
response
url = "http://environment.data.gov.uk/"
path = paste0("api/v1sites/http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F", site)
url = "http://environment.data.gov.uk/"
path = paste0("api/v1/sites/http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F", site)
response <- GET(url, path = path,
query = site)
jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
response
url = "https://environment.data.gov.uk/"
path = paste0("api/v1/sites/http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F", site)
response <- GET(url, path = path,
query = site)
jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
url = "https://environment.data.gov.uk/"
path = paste0("api/v1/sites/http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F", site)
response <- GET(url, path = path
)
jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
response
response
response
site = "10036"
url = "https://environment.data.gov.uk/"
path = paste0("api/v1/sites/http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F", site)
response <- GET(url, path = path
)
response
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/sites/http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F", site)
response <- GET(url, path = path
)
response
jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
data1 <- jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
data1 <- map(data, data.frame) %>% bind_rows()
data1
data1 <- jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
data1 <- map(data1, data.frame) %>% bind_rows()
data1
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/sites/http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F", site)
response <- GET(url, path = path)
data1 <- jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
data1
data.frame(data1)
data <- jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
data <- data.frame(data)
data
View(data)
data <- jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
data
View(data)
site = "42045"
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/sites/http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F", site)
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE)
data
data.frame(data)
data1 <- data.frame(data)
View(data1)
jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE, flatten = TRUE)
data <- jsonlite::fromJSON(content(response, "text"), simplifyVector = FALSE, flatten = TRUE)
data1 <- data.frame(data)
View(data)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data1 <- data.frame(data)
View(data1)
site = "42045"
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/sites/http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F", site)
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
View(data)
url = "https://environment.data.gov.uk/"
path = "ecology/api/v1/surveys?site_id=http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F42045"
response <- GET(url, path = path)
jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
View(data)
url = "https://environment.data.gov.uk/"
path = "ecology/api/v1/surveys/http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsampling%2Fbio%2F843011"
response <- GET(url, path = path)
jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
View(data)
site = "/environment.data.gov.uk/ecology/site/bio/201751"
parse_url(site)
build_url(site)
parse_url("http://google.com:80/?a=1&b=2")
site = "?/environment.data.gov.uk/ecology/site/bio/201751"
parse_url(site)
encodeString(site)
site = "/environment.data.gov.uk/ecology/site/bio/201751"
encodeString(site)
URLencode(site)
URLdecode(site)
site
URLdecode(URL = site )
URLencode(URL = site )
URLencode(URL = site,reserved = T )
site <- URLencode(URL = site,reserved = T)
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/sites/", site)
path
response <- GET(url, path = path)
jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
url
path
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/sites/http%3A%2F%", site)
path
response <- GET(url, path = path)
jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
path
path = paste0("ecology/api/v1/sites/http%3A%2F", site)
response <- GET(url, path = path)
jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
data
site = "/environment.data.gov.uk/ecology/site/bio/42045"
site <- URLencode(URL = site,reserved = T)
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/sites/http%3A%2F", site)
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
data
site
url = "https://environment.data.gov.uk/"
path = "ecology/api/v1/surveys?site_id=http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F42045"
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
data
View(data)
survey_id = "http://environment.data.gov.uk/ecology/sampling/bio/843011"
survey_id <- URLencode(URL = survey_id,reserved = T)
survey_id
survey_id = "http://environment.data.gov.uk/ecology/sampling/bio/843011"
survey_id <- URLencode(URL = survey_id,reserved = T)
survey_id
survey_id = "http://environment.data.gov.uk/ecology/sampling/bio/842951"
survey_id <- URLencode(URL = survey_id,reserved = T)
paste0("ecology/api/v1/surveys/http%3A%2F", survey_id)
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/surveys/http%3A%2F", survey_id)
response <- GET(url, path = path)
jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
survey_id
path = paste0("ecology/api/v1/surveys/", survey_id)
path
response <- GET(url, path = path)
jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
View(data)
url = "https://environment.data.gov.uk/"
path = "ecology/api/v1/surveys?site_id=http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F42045"
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
site = "/environment.data.gov.uk/ecology/site/bio/43378"
site <- URLencode(URL = site,reserved = T)
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/sites/http%3A%2F", site)
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
site = "/environment.data.gov.uk/ecology/site/bio/43378"
site <- URLencode(URL = site,reserved = T)
site
url = "https://environment.data.gov.uk/"
paste0("ecology/api/v1/surveys?site_id=http%3A%2F", site)
path = paste0("ecology/api/v1/surveys?site_id=http%3A%2F", site)
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
View(data)
response
date_to = "2016-01-03"
date_from = "2016-01-01"
url = "https://environment.data.gov.uk/"
paste0("ecology/api/v1/surveys?skip=0&take=250&date_to=", date_to , "&date_from=" , date_from)
path = paste0("ecology/api/v1/surveys?skip=0&take=250&date_to=", date_to , "&date_from=" , date_from)
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data
response
date_to = "2016-01-03"
date_from = "2016-01-01"
paste0("ecology/api/v1/surveys?skip=0&take=250&date_to=", date_to , "&date_from=" , date_from)
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/surveys?skip=0&take=250&date_to=", date_to , "&date_from=" , date_from)
response <- GET(url, path = path)
response
jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data
date_to = "2016-01-15"
date_from = "2016-01-01"
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/surveys?skip=0&take=250&date_to=", date_to , "&date_from=" , date_from)
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data
data <- data.frame(data)
data
get_survey <- function(survey_id) {
# survey_id = "http://environment.data.gov.uk/ecology/sampling/bio/842951"
survey_id <- URLencode(URL = survey_id,reserved = T)
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/surveys/", survey_id)
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
}
test <- map(data$survey_id, get_survey)
test2 <- bind_rows(test)
test[1:18]
test2 <- bind_rows(test[1:18])
View(test2)
bind_rows(test)
get_survey <- function(survey_id) {
# survey_id = "http://environment.data.gov.uk/ecology/sampling/bio/842951"
survey_id <- URLencode(URL = survey_id,reserved = T)
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/surveys/", survey_id)
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
data$observations.simple_result <- as.character(data$observations.simple_result)
return(data)
}
test <- map(data$survey_id[1:10], get_survey)
get_survey <- function(survey_id) {
# survey_id = "http://environment.data.gov.uk/ecology/sampling/bio/842951"
survey_id <- URLencode(URL = survey_id,reserved = T)
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/surveys/", survey_id)
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
data$observations.simple_result <- as.character(data$observations.simple_result)
return(data)
}
test <- map(data$survey_id[1:25], get_survey)
test2 <- bind_rows(test)
View(test2)
test <- map(data$survey_id, get_survey)
test2 <- bind_rows(test)
View(test2)
date_from = NULL
date_to = NULL
site = "/environment.data.gov.uk/ecology/site/bio/43378"
site <- URLencode(URL = site,reserved = T)
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/sites/http%3A%2F", site)
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
data
View(data)
unique(data$lon)
unique(data$lat)
lat = unique(data$lat)
long = unique(data$lon)
url = "https://environment.data.gov.uk/"
path = paste0("ecology/api/v1/surveys?skip=0&take=250&date_to=", date_to ,
"&date_from=" , date_from,
"&lat=", lat,
"&long=", lon)
date_from = NULL
date_to = NULL
path = paste0("ecology/api/v1/surveys?skip=0&take=250&date_to=", date_to ,
"&date_from=" , date_from,
"&lat=", lat,
"&long=", lon)
path
date_from
date_to
paste0("ecology/api/v1/surveys?skip=0&take=250&date_to=", date_to ,
"&date_from=" , date_from,
"&lat=", lat,
"&long=", lon)
lon
lat
lon = unique(data$lon)
paste0("ecology/api/v1/surveys?skip=0&take=250&date_to=", date_to ,
"&date_from=" , date_from,
"&lat=", lat,
"&long=", lon)
path = paste0("ecology/api/v1/surveys?skip=0&take=250&date_to=", date_to ,
"&date_from=" , date_from,
"&lat=", lat,
"&long=", lon)
response <- GET(url, path = path)
jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
paste0("ecology/api/v1/surveys?skip=0&take=250&lat=", lat,
"&long=", lon)
path = paste0("ecology/api/v1/surveys?skip=0&take=250&lat=", lat,
"&long=", lon)
response <- GET(url, path = path)
jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
data
data$survey_id
test <- map(data$survey_id[1:100], get_survey)
test2 <- bind_rows(test)
test2
View(test2)
unique(test2$observations.sample_of_label)
test <- map(data$survey_id, get_survey)
test2 <- bind_rows(test)
View(test2)
site <- c(159200, 10254)
paste("site_id", site, sep = "")
paste0("ecology/api/v1/sites/http%3A%2F", site)
paste("site_id", site, sep = "&")
paste("site_id=", site_url, site, sep = "")
site_url = "http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F"
paste("site_id=", site_url, site, sep = "")
unlist(paste("site_id=", site_url, site, sep = ""))
c(paste("site_id=", site_url, site, sep = ""))
sites <- paste("site_id=", site_url, site, sep = "")
paste0("ecology/api/v1/sites/http%3A%2F", sites)
path <- paste0("ecology/api/v1/sites/http%3A%2F", sites)
sites
path
site_url = "http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F"
site_path <- paste("site_id=", site_url, sites, sep = "")
site_path
site <- c(159200, 10254)
# site <- c(159200, 10254)
url <- "https://environment.data.gov.uk/"
site_url = "http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F"
site_path <- paste("site_id=", site_url, sites, sep = "")
path <- paste0("ecology/api/v1/sites/http%3A%2F", sites)
path
site_path
paste0("ecology/api/v1/sites/http%3A%2F", unlist(site_path))
paste("site_id=", site_url, sites, sep = "", collapse = "&")
url <- "https://environment.data.gov.uk/"
sites
sites <- c(159200, 10254)
url <- "https://environment.data.gov.uk/"
site_url = "http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F"
site_path <- paste("site_id=", site_url, sites, sep = "", collapse = "&")
site_path
path <- paste0("ecology/api/v1/sites/http%3A%2F", site_path)
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
View(data)
response
sites <- c(159200, 10254)
url <- "https://environment.data.gov.uk/"
site_url = "http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F"
site_path <- paste("site_id=", site_url, sites, sep = "", collapse = "&")
path <- paste0("ecology/api/v1/sites/", site_path)
response <- GET(url, path = path)
response
response
site_path
sites <- c(159200, 10254)
url <- "https://environment.data.gov.uk/"
site_url = "http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F"
site_path <- paste("site_id=", site_url, sites, sep = "", collapse = "&")
path <- paste0("/ecology/api/v1/observations?", site_path)
path
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
View(data)
sites <- c(159200, 10254)
url <- "https://environment.data.gov.uk/"
site_url = "http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F"
site_path <- paste("site_id=", site_url, sites, sep = "", collapse = "&")
path <- paste0("/ecology/api/v1/observations?skip=0&take=500&", site_path)
response <- GET(url, path = path)
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- data.frame(data)
View(data)
url <- "https://environment.data.gov.uk/"
library(usethis)
usethis::use_data(url)
library(ead)
obs <- get_observations(sites = c(159200, 10254))
library(ead)
obs <- get_observations(sites = c(159200, 10254))
View(obs)
lat = 50.1
lon = -2.2
latlon_path <- paste("lat=", lat, "lon", lon, sep = "", collapse = "&")
latlon_path
latlon_path <- paste("&lat=", lat, "&lon", lon, sep = "")
latlon_path
latlon_path <- paste("&lat=", lat, "&lon=", lon, sep = "")
latlon_path
take = 500
path <- paste0("/ecology/api/v1/observations?skip=0&take=",take)
sites = c(159200, 10254)
if(sites) {
site_url = "http%3A%2F%2Fenvironment.data.gov.uk%2Fecology%2Fsite%2Fbio%2F"
site_path <- paste("site_id=", site_url, sites, sep = "", collapse = "&")
path <- paste0(path,"&", site_path)
}
if(lat && long) {
latlon_path <- paste("&lat=", lat, "&lon=", lon, sep = "")
path <- paste0(path, latlon_path)
}
long = -2.1
if(lat && long) {
latlon_path <- paste("&lat=", lat, "&lon=", long, sep = "")
path <- paste0(path, latlon_path)
}
url
library(ead)
path
url
response <- GET(url, path = path)
response <- httr::GET(url, path = path)
response
data <- jsonlite::fromJSON(content(response, "text"), flatten = TRUE)
data <- jsonlite::fromJSON(httr::content(response, "text"), flatten = TRUE)
data <- data.frame(data)
data
